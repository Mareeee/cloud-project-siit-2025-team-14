<div class="album-container">
    <div class="album-card">
        <h1 class="album-title">Create Album</h1>

        <input type="text" placeholder="Album Title" [(ngModel)]="newAlbum.title" (blur)="touched.title = true"
            class="full-width" [class.invalid]="touched.title && !titleValid" />
        <div class="error" *ngIf="touched.title && !titleValid">
            Title is required (min 2 characters).
        </div>

        <input type="date" [(ngModel)]="newAlbum.releaseDate" (blur)="touched.releaseDate = true" class="full-width"
            placeholder="Release Date" [class.invalid]="touched.releaseDate && !dateValid" />
        <div class="error" *ngIf="touched.releaseDate && !dateValid">
            Release date is required.
        </div>

        <div class="dropdown-container">
            <button type="button" class="dropdown-btn" (click)="toggleGenreDropdown()"
                [class.invalid]="touched.genres && !genresValid">
                {{ newAlbum.genres.length ? newAlbum.genres.join(', ') : 'Select Genres' }}
                <span class="arrow" [class.open]="genreDropdownOpen">&#9662;</span>
            </button>
            <div class="dropdown-menu" *ngIf="genreDropdownOpen">
                <label *ngFor="let genre of availableGenres" class="dropdown-item">
                    <input type="checkbox" [value]="genre" (change)="toggleGenre(genre)"
                        [checked]="newAlbum.genres.includes(genre)" />
                    {{ genre }}
                </label>
            </div>
        </div>
        <div class="error" *ngIf="touched.genres && !genresValid">
            Select at least one genre.
        </div>

        <div class="dropdown-container">
            <button type="button" class="dropdown-btn" (click)="toggleArtistDropdown()">
                {{ getSelectedArtists() || 'Select Artists (optional)' }}
                <span class="arrow" [class.open]="artistDropdownOpen">&#9662;</span>
            </button>
            <div class="dropdown-menu" *ngIf="artistDropdownOpen">
                <label *ngFor="let artist of availableArtists" class="dropdown-item">
                    <input type="checkbox" [value]="artist.id" (change)="toggleArtist(artist.id)"
                        [checked]="selectedArtistIds.includes(artist.id)" />
                    {{ artist.name }}
                </label>
            </div>
        </div>

        <div class="checkbox-container">
            <label>
                <input type="checkbox" [(ngModel)]="createFullAlbum" />
                Create full album (add songs after creation)
            </label>
        </div>

        <button (click)="createAlbum()" class="create-btn" [disabled]="!formValid">Create Album</button>
    </div>

    <div class="snackbar" [class.show]="showSnackbar">{{ snackbarMessage }}</div>
</div>